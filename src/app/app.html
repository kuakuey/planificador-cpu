<link rel="preconnect" href="https://fonts.googleapis.com" />
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link
  href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&display=swap"
  rel="stylesheet"
/>

<section>
  <div class="div1">
    <h1>Planificador de CPU</h1>
    <div class="conection">
      <p>{{ status() }}</p>
      <button (click)="Conexion()">Iniciar</button>
    </div>
  </div>

  <div class="div2">
    <label>
      Algoritmo:
<select [(ngModel)]="algorithm">
  <option value="" disabled selected>Selecciona un algoritmo</option>
  <option value="FCFS">FCFS</option>
  <option value="SJF">SJF</option>
  <option value="RR">RR</option>
  <option value="PRIORITY">Priority</option>
    <option value="CHS">CHS</option>

</select>    </label>
    <button type="button" (click)="agregarProceso()">Agregar proceso</button>
  </div>

  <div id="process">
    <div *ngFor="let proceso of processes; let i = index" class="container-process">
      <h3>Proceso {{ i + 1 }}</h3>
      <label>
        Id:
        <input type="text" [(ngModel)]="proceso.id" placeholder="ID del proceso" />
      </label>
      <label>
        Tiempo de llegada:
        <input
          type="number"
          [(ngModel)]="proceso.arrivalTime"
          placeholder="Arrival Time"
          disabled
        />
      </label>
      <label>
        Tiempo de Ejecucion:
        <input type="number" [(ngModel)]="proceso.burstTime" placeholder="Burst Time" />
      </label>
      <label>
        Priority:
        <input type="number" [(ngModel)]="proceso.priority" placeholder="Priority" />
      </label>
      <button type="button" (click)="eliminarProceso(i)">Eliminar</button>
    </div>
  </div>
</section>

<!-- Popup -->
<!-- Popup -->
<div class="pop-up" *ngIf="mostrarPopUp">
  <div class="pop-up-contenido">
    <!-- Título -->
    <h3>Algoritmo: {{ dataPopUp.algorithm }}</h3>

    <!-- Gantt Timeline -->
    <div class="gantt-timeline">
      <div class="gantt-row" *ngFor="let t of dataPopUp.timeline">
        <span class="gantt-label">Proceso {{ t.processId }}</span>
        <div
          class="gantt-bar"
          [style.width.%]="(t.end - t.start) * escala"
          [style.marginLeft.%]="t.start * escala"
        >
          {{ t.end - t.start }}
        </div>
      </div>
    </div>
        <div class="metrics" *ngIf="mostrarPopUp">
            <p><b>Tiempo de Respuesta Promedio:</b> {{ dataPopUp.metrics.avgResponseTime }}</p>
            <p><b>Tiempo de Retorno Promedio:</b> {{ dataPopUp.metrics.avgTurnaroundTime }}</p>
            <p><b>Tiempo de Espera Promedio:</b> {{ dataPopUp.metrics.avgWaitingTime }}</p>
            <p><b>Cambios de Contexto:</b> {{ dataPopUp.metrics.contextSwitches }}</p>
            <p><b>Utilización CPU:</b> {{ dataPopUp.metrics.cpuUtilization }}</p>
            <p><b>Rendimiento:</b> {{ dataPopUp.metrics.throughput }}</p>
        </div>
    <!-- Botón para cerrar -->
    <button (click)="cerrarPopUp()">Cerrar</button>
  </div>
</div>
